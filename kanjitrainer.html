<html>
<head>
  <style>
   #kanji {
       font-size: 300%;
   }

   #freeform {
       float: left;
   }
  </style>
  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
  <script>
   $(document).ready(function() {
       $("#freeform-input").keydown(function(event) {
           if (event.keyCode == 13) {
               $("#freeform-button").click();
           }
       })
   })
   function validate(value) {
       $.post('/_validate', {'answer': value},
              function(data) {
                  $("#happiness")[0].src = data.happy_img;
                  $("#button0").html(data.choices[0]);
                  $("#button1").html(data.choices[1]);
                  $("#button2").html(data.choices[2]);
                  $("#kanji").html(data.kanji_char);
                  $("#correct").html("Correct char index: " + data.correct +
                                     "<br><br>Correct/Total: " + data.score +
                                     " / " + data.total + 
                                     "<br>Avg: " + data.perc + 
                                     "<br>Exponentially weighted moving average: " + data.ewma +
                                     "<br>Current Streak: " + data.streak + 
                                     "<br>Top Streak: " + data.top_streak + 
                                     "<br>Prediction: " + data.predict)
              },
              'json');
   }

   function validate_freeform() {
       text = $("#freeform-input").val().toLowerCase();
       $("#freeform-input").val("");
       return validate(text);
   }

   function validate_choice(choice) {
       text = $("#button" + choice).html();
       validate(text);
   }
  </script>
</head>
<body>
  <img id="happiness" src="{{ happy_img }}" height=300px/>
  <div id="kanji">{{ kanji_char }}</div>
  <div class="input">
    <ul id="answers">
      <li><button id="button0" onclick="validate_choice(0)">{{ choices[0] }}</button></li>
      <li><button id="button1" onclick="validate_choice(1)">{{ choices[1] }}</button></li>
      <li><button id="button2" onclick="validate_choice(2)">{{ choices[2] }}</button></li>
    </ul>
    <div id="freeform">
      <input id="freeform-input" type="text">
      <button id="freeform-button" onclick="validate_freeform()">Submit</button>
    </div>
  </div>
  <br><br>
  <div id=correct></div>
  <div id=streak></div>
</body>
</html>
